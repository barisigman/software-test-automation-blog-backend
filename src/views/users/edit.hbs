<div class="container">
  <h1>Edit {{user.first_name}} {{user.last_name}}</h1>
</div>

<div class="container mb-3">
  <form action="{{route 'users/update' id=user.uuid}}?_method=patch" method="POST">
    <div class="form-group">
      <label for="firstName">First Name</label>
      <input
        class="form-control{{#if messages.errors.0.firstName}} is-invalid{{/if}}{{#if messages.old.0.firstName}} is-valid{{/if}}"
        type="text" name="firstName" id="firstName"
        value="{{#if messages.old.0.firstName}}{{messages.old.0.firstName}}{{else}}{{user.first_name}}{{/if}}">
      {{#if messages.errors.0.firstName}}
      <span class="invalid-feedback d-block">{{messages.errors.0.firstName}}</span>
      {{/if}}
    </div>
    <div class="form-group">
      <label for="lastName">Last Name</label>
      <input
        class="form-control{{#if messages.errors.0.lastName}} is-invalid{{/if}}{{#if messages.old.0.lastName}} is-valid{{/if}}"
        type="text" name="lastName" id="lastName"
        value="{{#if messages.old.0.lastName}}{{messages.old.0.lastName}}{{else}}{{user.last_name}}{{/if}}">
      {{#if messages.errors.0.lastName}}
      <span class="invalid-feedback d-block">{{messages.errors.0.lastName}}</span>
      {{/if}}
    </div>
    <div class="form-group">
      <label for="email">E-mail</label>
      <input
        class="form-control{{#if messages.errors.0.email}} is-invalid{{/if}}{{#if messages.old.0.email}} is-valid{{/if}}"
        type="email" name="email" id="email"
        value="{{#if messages.old.0.email}}{{messages.old.0.email}}{{else}}{{user.email}}{{/if}}">
      {{#if messages.errors.0.email}}
      <span class="invalid-feedback d-block">{{messages.errors.0.email}}</span>
      {{/if}}
    </div>
    <div class="form-group">
      <label for="roleName">Role</label>
      <select class="form-control" name="roleName" id="roleName">
        {{#each roles}}
        {{#dataValues}}

        {{#each @root.user.roles}}
        {{#dataValues}}

        {{#eq name ../../name}}
        <option value="{{name}}" selected>{{name}}</option>
        {{else}}
        <option value="{{../../name}}">{{../../name}}</option>
        {{/eq}}

        {{/dataValues}}
        {{/each}}

        {{/dataValues}}
        {{/each}}
      </select>
    </div>
    <a href="{{route 'users' }}" class="btn btn-primary">
      <i class="fas fa-arrow-left mr-1"></i>
      Cancel
    </a>
    <button type="submit" class="btn btn-success float-right">
      <i class="fas fa-save mr-1"></i>
      Update User
    </button>
  </form>
</div>
